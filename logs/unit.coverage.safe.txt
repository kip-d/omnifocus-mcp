
 RUN  v3.2.4 /Users/kip/codex/omnifocus-mcp
      Coverage enabled with v8

 ✓ tests/unit/tools/base.test.ts (30 tests) 48ms
 ✓ tests/unit/tools/projects/ProjectsToolV2.test.ts (30 tests) 23ms
 ✓ tests/unit/tools/system-v2.test.ts (8 tests) 79ms
 ✓ tests/unit/timezone.test.ts (31 tests) 160ms
 ✓ tests/unit/tools/analytics.test.ts (30 tests) 30ms
 ✓ tests/unit/code-changes-verification.test.ts (5 tests) 156ms
 ✓ tests/unit/tools/export.test.ts (32 tests) 30ms
 ✓ tests/unit/tools/tasks/QueryTasksToolV2.test.ts (36 tests) 28ms
 ✓ tests/unit/response-format-consistency.test.ts (11 tests) 14ms
 ✓ tests/unit/omnifocus/scripts/ScriptBuilder.test.ts (29 tests) 5ms
 ✓ tests/unit/tools/task-crud.test.ts (30 tests) 27ms
 ✓ tests/unit/tools/folders.test.ts (21 tests) 28ms
 ✓ tests/unit/tools/tags-v2.test.ts (13 tests) 10ms
 ✓ tests/unit/omnifocus/OmniAutomation.test.ts (24 tests) 24ms
 ✓ tests/unit/performance-optimizations.test.ts (15 tests) 6ms
 ✓ tests/unit/tools/list-projects-tool.test.ts (9 tests) 53ms
 ✓ tests/unit/tools/export-bulk.test.ts (11 tests) 93ms
 ✓ tests/unit/tools/recurring.test.ts (14 tests) 33ms
 ✓ tests/unit/completed-project-tasks.test.ts (11 tests) 5ms
 ✓ tests/unit/tools/project-crud.test.ts (14 tests) 12ms
 ✓ tests/unit/omnifocus/RobustOmniAutomation.test.ts (14 tests) 9ms
 ✓ tests/unit/type-adapters.test.ts (13 tests) 5ms
 ✓ tests/unit/utils/response-format-utilities.test.ts (34 tests) 11ms
 ✓ tests/unit/tools/perspectives-v2.test.ts (8 tests) 32ms
 ✓ tests/unit/tools/tasks/query-tasks-smart-suggest.test.ts (3 tests) 8ms
 ✓ tests/unit/tools/folders/folders-consolidated.test.ts (10 tests) 12ms
 ✓ tests/unit/tools/analytics/workflow-analysis-tool.test.ts (4 tests) 5ms
 ✓ tests/unit/tools/list-tasks-tool.test.ts (7 tests) 7ms
 ✓ tests/unit/tools/analytics/pattern-analysis-v2.test.ts (3 tests) 14ms
 ✓ tests/unit/utils/schema-validation.test.ts (35 tests) 6ms
 ✓ tests/unit/cache-manager.test.ts (28 tests) 11ms
 ✓ tests/unit/omnifocus/scripts/bridge-template.test.ts (33 tests) 4ms
 ✓ tests/unit/tools/index-tools-registration.test.ts (1 test) 8ms
 ✓ tests/unit/omnifocus/plugins/core-recurring-analyzer.test.ts (5 tests) 5ms
 ✓ tests/unit/tools/reviews/manage-reviews.test.ts (6 tests) 5ms
 ✓ tests/unit/tools/tasks/query-tasks-upcoming.test.ts (3 tests) 11ms
 ✓ tests/unit/tools/export/export-tool.test.ts (5 tests) 6ms
 ✓ tests/unit/omnifocus/scripts/script-builder.test.ts (23 tests) 10ms
 ✓ tests/unit/tools/schemas/project-schemas.test.ts (8 tests) 4ms
stdout | tests/unit/tag-conversion.test.ts > Tag Type Conversion Issues > should check for array/object conversion patterns in tag scripts
\nAnalyzing LIST_TAGS_SCRIPT for type conversion issues:
  Found 1 instances of pattern 5: \.map\(
\nAnalyzing MANAGE_TAGS_SCRIPT for type conversion issues:
  Found 2 instances of pattern 1: \.push\([^)]+\)(?!;)
  Found 1 instances of pattern 2: \.addTags\(\[
  Found 1 instances of pattern 3: \.removeTags\(\[
  Found 1 instances of pattern 5: \.map\(

stdout | tests/unit/tag-conversion.test.ts > Tag Type Conversion Issues > should identify complex object serialization
\nFound complex serialization patterns:
  LIST_TAGS: 27 instances
  MANAGE_TAGS: 26 instances
\nFound complex serialization patterns:
  LIST_TAGS: 1 instances

 ✓ tests/unit/tag-conversion.test.ts (3 tests) 3ms
 ✓ tests/unit/mcp-client.test.ts (2 tests) 6ms
 ✓ tests/unit/tools/tasks/manage-task-tool.test.ts (6 tests) 9ms
 ✓ tests/unit/omnifocus/plugins/gaming-recurring-analyzer.test.ts (4 tests) 2ms
 ✓ tests/unit/utils/error-messages.test.ts (10 tests) 5ms
 ✓ tests/unit/utils/permissions.test.ts (6 tests) 3ms
 ✓ tests/unit/task-search-limit.test.ts (3 tests) 3ms
 ✓ tests/unit/utils/logger.test.ts (3 tests) 20ms
 ↓ tests/unit/integration.test.ts (7 tests | 7 skipped)
 ✓ tests/unit/tag-operations.test.ts (4 tests) 2ms
 ↓ tests/unit/test-data-management.test.ts (6 tests | 6 skipped)

 Test Files  48 passed | 2 skipped (50)
      Tests  688 passed | 13 skipped (701)
   Start at  23:51:09
   Duration  2.86s (transform 1.77s, setup 2.10s, collect 4.32s, tests 1.09s, environment 9ms, prepare 4.39s)

 % Coverage report from v8
-------------------|---------|----------|---------|---------|-------------------
File               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
-------------------|---------|----------|---------|---------|-------------------
All files          |   78.61 |    76.15 |   84.24 |   78.61 |                   
 src               |       0 |      100 |     100 |       0 |                   
  index.ts         |       0 |      100 |     100 |       0 | 2-80              
 src/cache         |    88.8 |      100 |      90 |    88.8 |                   
  CacheManager.ts  |    88.8 |      100 |   88.88 |    88.8 | 125-140           
  types.ts         |       0 |        0 |       0 |       0 |                   
 src/omnifocus     |      58 |       90 |   54.83 |      58 |                   
  ...Automation.ts |    12.5 |      100 |   16.66 |    12.5 | ...40-127,130-215 
  ...Automation.ts |   54.92 |    91.66 |   66.66 |   54.92 | ...31-381,384-416 
  ...Automation.ts |     100 |    85.71 |     100 |     100 | 48-49,127,147,171 
  jxa-types.ts     |       0 |      100 |     100 |       0 | 304-325           
  ...sult-types.ts |   68.96 |      100 |   16.66 |   68.96 | ...63-169,176-189 
  script-types.ts  |       0 |        0 |       0 |       0 |                   
  types.ts         |       0 |      100 |     100 |       0 | 24                
 src/omnifocus/api |   77.18 |    83.73 |   73.33 |   77.18 |                   
  OmniFocus.d.ts   |       0 |        0 |       0 |       0 |                   
  api-types.ts     |       0 |        0 |       0 |       0 |                   
  index.ts         |       0 |      100 |     100 |       0 | 11-31             
  type-adapters.ts |   79.89 |    83.33 |   66.66 |   79.89 | ...58-361,367-370 
 ...ifocus/plugins |   68.23 |     65.9 |   93.75 |   68.23 |                   
  ...ngAnalyzer.ts |   66.66 |    68.75 |     100 |   66.66 | ...35,239-240,242 
  ...ngAnalyzer.ts |   74.54 |    60.52 |   85.71 |   74.54 | ...26,228-229,231 
  index.ts         |       0 |      100 |     100 |       0 | 5-23              
  types.ts         |       0 |        0 |       0 |       0 |                   
 src/tools         |   80.41 |    81.39 |     100 |   80.41 |                   
  base.ts          |    84.3 |    83.62 |     100 |    84.3 | ...07,309,320-321 
  index.ts         |   66.29 |       50 |     100 |   66.29 | ...05-123,127-134 
  ...e-types-v2.ts |       0 |        0 |       0 |       0 |                   
  ...onse-types.ts |       0 |      100 |     100 |       0 | 7                 
  types.ts         |       0 |        0 |       0 |       0 |                   
 ...ools/analytics |   86.59 |    75.51 |   97.14 |   86.59 |                   
  ...ysisToolV2.ts |   89.92 |    76.08 |     100 |   89.92 | ...47-148,160-162 
  ...ysisToolV2.ts |    83.6 |    71.09 |     100 |    83.6 | ...25,982,996-997 
  ...tatsToolV2.ts |   89.33 |    80.95 |     100 |   89.33 | ...76-181,185-186 
  ...cityToolV2.ts |   89.61 |    81.25 |      80 |   89.61 | ...04-208,213-217 
  ...alysisTool.ts |   90.78 |    76.19 |     100 |   90.78 | 131-140,172-174   
 src/tools/export  |   79.11 |    65.38 |     100 |   79.11 |                   
  ...ExportTool.ts |   61.53 |       50 |     100 |   61.53 | 39,61,83,115-167  
  ...ojectsTool.ts |     100 |    85.71 |     100 |     100 | 33                
  ...tTasksTool.ts |   75.43 |    64.28 |     100 |   75.43 | 45,47-60          
  ExportTool.ts    |   98.05 |    88.88 |     100 |   98.05 | 131-132           
 src/tools/folders |   81.24 |    72.07 |   94.73 |   81.24 |                   
  FoldersTool.ts   |    96.2 |    93.54 |     100 |    96.2 | 267-273,276-277   
  ...FolderTool.ts |   79.75 |       70 |     100 |   79.75 | ...02-209,241-248 
  ...oldersTool.ts |   67.39 |     57.5 |   85.71 |   67.39 | ...90,208-256,273 
 ...s/perspectives |   85.71 |    71.87 |     100 |   85.71 |                   
  ...ivesToolV2.ts |   85.71 |    71.87 |     100 |   85.71 | ...93-200,236-243 
 ...tools/projects |    72.8 |    67.47 |    92.3 |    72.8 |                   
  ...ectsToolV2.ts |    72.8 |    67.47 |    92.3 |    72.8 | ...39-547,562-605 
 ...ools/recurring |   79.67 |    53.65 |   85.71 |   79.67 |                   
  ...gTasksTool.ts |     100 |    61.53 |     100 |     100 | 14-18             
  ...tternsTool.ts |   91.04 |    46.15 |     100 |   91.04 | 61-62,67-68,72-73 
  ...gTasksTool.ts |   55.07 |      100 |   66.66 |   55.07 | 58-93             
 src/tools/reviews |   75.94 |    55.35 |     100 |   75.94 |                   
  ...eviewsTool.ts |   75.94 |    55.35 |     100 |   75.94 | ...52-353,359-360 
 src/tools/schemas |   84.36 |    70.83 |   27.27 |   84.36 |                   
  ...schemas-v2.ts |     100 |      100 |     100 |     100 |                   
  ...cs-schemas.ts |       0 |        0 |       0 |       0 | 1-127             
  ...on-helpers.ts |   91.66 |    77.77 |     100 |   91.66 | 24                
  ...ed-schemas.ts |     100 |      100 |     100 |     100 |                   
  ...rt-schemas.ts |     100 |      100 |     100 |     100 |                   
  ...er-schemas.ts |     100 |      100 |       0 |     100 |                   
  index.ts         |       0 |        0 |       0 |       0 | 1-10              
  ...ct-schemas.ts |     100 |      100 |     100 |     100 |                   
  ...at-schemas.ts |   70.42 |      100 |       0 |   70.42 | ...72-283,287-298 
  ...ed-schemas.ts |   84.37 |      100 |       0 |   84.37 | 83-92             
  ...em-schemas.ts |     100 |      100 |     100 |     100 |                   
  tag-schemas.ts   |       0 |        0 |       0 |       0 | 1-72              
  task-schemas.ts  |   99.52 |      100 |     100 |   99.52 | 334-335           
 src/tools/system  |   91.02 |    85.71 |     100 |   91.02 |                   
  SystemToolV2.ts  |   91.02 |    85.71 |     100 |   91.02 | 284-289,307-314   
 src/tools/tags    |   86.46 |    72.72 |     100 |   86.46 |                   
  TagsToolV2.ts    |   86.46 |    72.72 |     100 |   86.46 | ...90-302,328-329 
 src/tools/tasks   |    76.3 |    68.51 |     100 |    76.3 |                   
  ...teTaskTool.ts |   94.87 |    70.58 |     100 |   94.87 | 67-68,70-71       
  ...teTaskTool.ts |   51.97 |     75.6 |     100 |   51.97 | ...30-143,179-180 
  ...teTaskTool.ts |   95.06 |    68.75 |     100 |   95.06 | 64-65,67-68       
  ...geTaskTool.ts |   94.88 |    86.66 |     100 |   94.88 | 215-221,224-225   
  ...asksToolV2.ts |   76.39 |    66.93 |     100 |   76.39 | ...08-721,723-735 
  ...teTaskTool.ts |   64.54 |     61.4 |     100 |   64.54 | ...88-289,293-294 
 src/utils         |   77.94 |    89.52 |    78.2 |   77.94 |                   
  ...r-messages.ts |     100 |      100 |   63.15 |     100 |                   
  logger.ts        |     100 |    93.93 |     100 |     100 | 26-27             
  permissions.ts   |   93.18 |    85.18 |     100 |   93.18 | 70-75             
  ...-format-v2.ts |   93.96 |    88.95 |     100 |   93.96 | ...34,537-543,565 
  ...nse-format.ts |   68.14 |      100 |      75 |   68.14 | ...64-174,180-197 
  safe-io.ts       |    25.8 |      100 |       0 |    25.8 | ...67,70-75,80-85 
  timezone.ts      |   82.22 |    85.71 |     100 |   82.22 | ...,52-74,179-180 
  type-guards.ts   |       0 |      100 |     100 |       0 | 8-105             
  version.ts       |    8.19 |      100 |       0 |    8.19 | 43-130            
-------------------|---------|----------|---------|---------|-------------------
